\documentclass[10pt, b5paper, twoside]{book}
\usepackage[inner=2cm, outer=2.5cm, top=2.7cm, bottom=3.0cm]{geometry}
%\usepackage[lmargin=25mm,rmargin=25mm,tmargin=27mm,bmargin=30mm]{geometry}

\usepackage[parfill]{parskip}  % To begin paragraphs with an empty line rather than an indent
\usepackage{lmodern}
\usepackage[utf8]{inputenc} %Allow norwegian letters
\usepackage[T1]{fontenc}		% norsk tegnsett (æøå)

\usepackage{hyperref}
\usepackage{graphicx} % To include images
\usepackage[english]{babel}

\usepackage{amsmath} %Math
\usepackage{amsthm} %Math?
\usepackage{url} %Get url in referencelist
\usepackage{emptypage} %Removes pagenumber on empty pages 
\usepackage{setspace} %To use doublespacing / singlespacing ++

\usepackage{xcolor} %color on box background

%BOX
\usepackage{framed}
\setlength\FrameSep{0.5em}
\setlength\OuterFrameSep{\partopsep}
%Colored box
\usepackage{tcolorbox}

\usepackage{graphicx}

%Small font on the caption on figures
\usepackage[font={small}]{caption}
\usepackage[font={small}]{subcaption}

%Force figure placement
\usepackage{float}

%SVG images
\usepackage{svg}

%Easy list
\usepackage{amssymb}

\usepackage[toc]{glossaries}%Adding glossary, and adding it to contents with chapter layout

%--------------------  Header and footer layout-----------------
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} % Clear all header and footer fields

%L = left, R = right, C=center, O = odd page, E = even page
\fancyhead[LE]{\leftmark} %\leftmark sets number and name of chapter
\fancyfoot[LE,RO]{\thepage} %\thepage gives page number

% redefinition of the plain style: Otherwise first page of new chapter gets original plain style
\fancypagestyle{plain}{%
	\fancyhf{} % clear all header and footer fields
	\renewcommand{\headrulewidth}{0pt} %Remove header line on new 
	\fancyfoot[LE,RO]{\thepage} %\ "thepage" gives page number
}


% --------- CODE LAYOUT ----------------
% Inserting code and making it look readable (adding numbering, colours and formatting)
\usepackage{listings} %insert code style
\usepackage{color}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\lstdefinestyle{pythonstyle}{
    backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{blue},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,   %Makes underscore look correct             
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}

%Making space between background box and content
\usepackage{fancyvrb}
\usepackage{framed}
\lstset{
	style=pythonstyle,
	framexleftmargin=1pt,
	framextopmargin=8pt,
	framexbottommargin=6pt, 
	frame=tb, framerule=0pt
}


%-------------------- TOC layout ----------------------------------------------------
\usepackage{titletoc}

\titlecontents{chapter}[1.5pc]
{\filright}
{\contentslabel{1.5pc}}{\hspace*{-1.5pc}}
{\titlerule*[0.7pc]{.}\contentspage}

\titlecontents{section}[3.5pc]
{\addvspace{-0.4pc}\filright\footnotesize} %space between lines
{\contentslabel{2pc}}{\hspace*{-2pc}}
{\titlerule*[0.7pc]{.}\contentspage} %space between dots

\titlecontents{subsection}[4.5pc]
{\addvspace{-0.4pc}\filright\footnotesize} %space between lines
{\contentslabel{2pc}}{\hspace*{-2pc}}
{\titlerule*[0.7pc]{.}\contentspage} %space between dots

%Set levels in contents:
\setcounter{tocdepth}{3}
\setcounter{secnumdepth}{3}

%-------------------- Make chapter layout better ------------------------------------
\usepackage{titlesec}
%\titleformat{\chapter}[hang] 

\usepackage{titlesec, blindtext, color}
\definecolor{gray75}{gray}{0.75}
\newcommand{\hsp}{\hspace{20pt}}

%Setting layot to line between number and name, setting the color to gray and adding space
\titleformat{\chapter}[hang]{\Huge\bfseries}{\thechapter\hsp\textcolor{gray75}{|}\hsp}{0pt}{\Huge\bfseries}

%{\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter. }{0.7em}{}%[{\titlerule[0.2pt]}] %underline

\makeatletter %Decide layout for chapter header
\renewcommand{\@chapapp}{}% Remove "Chapter" before chap number
\newenvironment{chapquote}[2][2em]
%------------------------------------------------------------------



%\usepackage{titlepic}

%\usepackage{subfig}
%\usepackage{subcaption}

\usepackage[toc,page]{appendix}

%Bibliography definitons
\usepackage{natbib}
\usepackage{apalike}


%Set levels in contents:
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{2}